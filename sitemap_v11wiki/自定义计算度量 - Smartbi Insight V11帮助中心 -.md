
# 1 概述
度量分两种：度量(原子度量)和计算度量
  * 原子度量：指从维度里直接获取到的,详参：创建度量。
  * 计算度量：是用多维表达式创建一个虚拟字段的数值，它不改变源数据，也不改变数据模型，如果你不在报表上使用它，甚至不知道它是什么样子的，而一旦被拖拽到报表上，便会随着各种筛选和维度展现不同的数据，所以计算度量一般在报表交互时使用。


前置条件
1、如果开启了SQL引擎，勾选了计算度量可能无法走SQL引擎取数，详参：SQL引擎介绍。
2、内置的向导：数学运算、时间计算、汇总计算、文本转换、命名集几大类的向导，详参：自定义表达式模板
3、在报表层创建计算度量，可参考：仪表盘创建计算度量、透视分析创建计算度量 。
4、计算度量 **函数** 模式支持参数，可参考：参数设置；**向导** 模式不支持 参数。
5、报表层支持创建计算度量：在报表层创建的向导计算度量只会保存在对应的报表中，不会保存在模型中；如果要保存在模型中供其他报表使用，需在模型中创建。
6、计算度量校验说明，可参考章节”6 计算度量校验说明“。
# 2 关于计算度量
Smartbi提供了2种创建计算度量的模式：向导、函数。
向导 | 向导：故名思义，“向导模式”就是通过在后台配置好多维表达式，再在界面上通过拖拉拽维度或度量无需任何代码，即可实现一个新的计算度量。  
---|---  
函数 |  函数：多维提供了很多函数，通过多维表达式可以把多个函数进行组合运用，从而得到新的计算度量。 多维表达式它有自己的语法，如果想了解多维表达式的，可查阅：数据模型引擎的基本语法及概念。  
特点 | 
  * 不被存储。
  * 在使用时才计算(因此会根据上下文筛选而变动)。
  * 消耗CPU。

  
## 3 示例说明  
报表层  
## 4 计算度量更多操作
目录 | 
  * 可通过目录对计算度量等进行也归类，方便使用。
  * 添加查询时到模型，会自动识别度量，并且在存放在度量区以 **查询** 名称 命名的目录下。
  * 目录目前仅支持一级目录。

  
---|---  
编辑 | 建好了计算度量，如果发现数据不对，可以重新进入页面编辑  
复制 | 在写好了一个计算度量，如果发现后面的度量也差不多是这个定义，可以先复制，再编辑微调，这样子可以提高效率。  
删除 | 如果把 计算度量 删除了，需要 **保存** 才会生效。  
移动到 | 可把计算度量移动到别的目录下；支持选中单个目录移动到，也支持按住Ctrl+批量选中多个字段一起移动到其他目录或者度量根目录。  
属性 | 
  * 数据格式: 如果发现计算展示出来的效果格式不太对，可以重新选择其他格式或者去新建数据格式，详参：数据格式。
  * 脱敏规则：
  * 度量出来的是一个数值，如果想要显示成分组的效果或者用字符串进行替换的效果可以设置转换规则；比如0-100是的不达标，101-200是达标，200以上及格，那么就可以使用转换规则；详参：转换规则。

  
## 5 计算度量使用的常用函数
## 6 计算度量校验说明
  * **只支持 多行注释 /** * */， 可换行 。 
  * 计算度量使用封装的函数的输入参数是字符串没有加单引号提示会异常信息
  * 如果函数名如果是统一函数，则需要校验参数个数、参数顺序、参数类型，目前还没校验。
  * 高级选项 DATA_MODEL_CHECK_EXPRESSION_BEFOR_SAVE 默认为 true 控制点击【确定】前是否校验，如果不想校验，可以把设置项改成false。

  
