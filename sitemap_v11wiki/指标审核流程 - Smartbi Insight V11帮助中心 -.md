
## 1 用户预定义
指标管理系统中，我们要实现的是如下业务操作：
  * **系统运维人员：** 初始化指标库，即将已有的维度、指标、维表和事实表在指标库中预定义好，业务人员可以在这个指标库的基础上进行指标的增改维护；同时对指标管理系统进行管理维护。
  * **业务人员：** 仅对指标库中的维度和指标（包含原子指标、计算指标）进行增改维护，其中指标的维护操作需要走审批流程才能生效。
  * **主管部门审批人员：** 当业务人员提交了指标的维护操作后，需要先由指标的主管部门进行审批。
  * **数管中心审批人员：** 主管部门审批人员审批通过后，由数管中心审批人员进行审批指标存储定义。


因此，在构建指标库之前，我们需要预定义好指标使用过程中的用户及角色：
角色 | 说明 | 权限设置  
---|---|---  
资源权限 | 操作权限  
系统运维角色 | 需要由用户定义的角色 |  指标模型目录及节点：编辑权限 维度：编辑权限 指标：编辑权限 维表：编辑权限 事实表：编辑权限 模型管理：编辑权限 指标存储库及库表：编辑权限 |  指标模型及子孙节点的操作权限：  
需要由用户定义的角色 |  指标模型目录及节点：查看权限 维度：编辑权限 指标：编辑权限 模型管理：查看权限 指标存储库及库表：引用权限 注意 若业务员角色需要修改维度和原子指标的关联表时，需要给业务员角色授维表和事实表的查看权限。 |  指标管理和新建指标的操作权限：  
主管部门审批角色 | 系统内置角色 |  指标模型目录及节点：编辑权限 维度：编辑权限 指标：编辑权限 维表：编辑权限 事实表：编辑权限 指标存储库及库表：编辑权限 | 不需要进行操作权限设置，保持系统设置即可。  
数管中心审批角色 | 系统内置角色 |  指标模型目录及节点：编辑权限 维度：编辑权限 指标：编辑权限 维表：编辑权限 事实表：编辑权限 指标存储库及库表：编辑权限 | 不需要进行操作权限设置，保持系统设置即可。  
## 2 审批流程
指标是指标体系中的核心资源，因此在实际业务工作中，指标的新建和修改需要进行严格的审核流程控制，不允许随便新增和修改。
系统内置的指标的审核流程如下，项目可根据实际业务修改流程定义：
一旦业务用户在指标管理系统中新增和修改指标，都将走审核流程：由主管部门和数管中心先后审批通过，该指标才能在指标库中生效。
下面，我们详细演示从业务员创建新指标提交审批，到主管部门审批，最后到数管部门审批的流程。
### 2.1 业务人员提交审批
当前文档以“合同金额”原子指标为例，演示业务员提指标的过程：
1、业务员登录系统，在“指标管理”界面单击**新建指标**
2、进入到新建指标流程发起页面，业务员按照下图填写“合同金额”指标的属性：
填好之后，维度设置，再进入存储设置：
3、填写完指标的业务属性后，我们单击**下一步**
4、完成以上步骤后，单击右上角的**提交**
### 2.2 主管部门指标审批
主管部门通常是从业务的角度对指标进行审批。
1、用主管部门审批用户登录系统，单击**我的待办** ，进入“我的待办”界面。
2、找到业务员小陈新建的指标“合同金额”的流程，双击主题，进入到该指标的审核界面：
3、主管部门审批用户，单击**下一步** ，检查各项设置，若没问题则审核通过，单击**提交**
### 2.3 数管部门数据审批
数据部门的审批主要是操作两项内容：设置指标存储和为指标所存储的事实表灌数。
1、用数管部门审批用户登录系统，单击**我的待办** ，进入“我的待办”界面。
2、找到业务员小陈新建的指标“合同金额”的流程，双击主题，进入到该指标的审核界面，审批用户单击两次**下一步****存储设置** ，进入到“存储设置”界面：
3、设置指标所属的事实表：我们想将指标“合同金额”放入到表“合同事实”中，该表已经存在，但是没有映射“合同金额”的字段，因此我们需要编辑表“合同事实”添加字段。我们单击**手工创建**
4、在“事实表管理”界面，找到表“合同事实”，在操作栏中单击**打开** ，打开该事实表的编辑页面：按照下图增加字段“合同金额”，并单击**保存**
5、返回到流程处理界面，设置好“合同金额”的事实表和字段：
6、由于该指标所属的事实表已经绑定自助ETL，因此直接审核没问题后，单击**提交**  
