
# **1 概述**
数据模型中目前已经支持了9种查询："数据源表"、"导入文件"、"SQL查询"、"即席查询"、"Java查询"、"脚本查询"、"存储过程查询"、"ETL高级查询"、"生成日期表"
每种查询的适用场景和操作说明在查询并准备数据中已经介绍。
下文介绍各个查询通用的一些设置、说明。
# **2 查询右键菜单**
各个 **查询** 加入到模型关系区，选中查询，或者点击旁边的出现右键菜单：
1、有时候发现数据不是自己想要的，可以编辑查询；编辑时，可能会改变原有查询的定义或者输出，可能会改变字段名称、类型；改变了之后可能需要重新设置字段关系或需要重新构建模型；如果是抽取模式，保存时会提示重新抽取，详细可查阅 2、除了【数据源表】无法编辑之外，其他查询都可以进行编辑，其中【导入文件】的编辑是追加数据，详情可查看导入文件数据。  
---  
目前只有【数据源表】才有同步功能; 比如加入到数据模型的【数据源表】，对应的底层业务库中的表更改了数据类型，然后想同步到数据模型中，可以选中查询再右键菜单的“同步”把数据类型同步成最新的。如果源表中增加字段后，还需先在数据源进行同步，再在模型同步，数据模型中的同步并不能直接同步库表的字段。  
复制 是 复制查询的定义，不会影响被复制的查询；大部分是解决用户不想重复工作的情况，比如复制已写好SQL查询，可减少重新编写SQL语句的时间，提高工作效率。 1、复制查询，复制后的命名方式：以原查询名词2,3,4依次增加 。 2、另外注意：复制【生成日期表】，复制后编辑进入【生成日期表】的“表名”会自动增加a,b,c....依次增加。  
创建查询与其他查询的关系，详细可参考设置查询关系。  
**转为ETL高级查询** |  1、比如想要制作宽表、想加工跨库数据，可以把查询转成ETL高级查询去实现。 2、目前除了 **ETL高级查询”** 不能转为ETL高级查询，其他查询均可转ETL高级查询。 **3、数据源表** 转为高级ETL查询之后，会自动把对应的数据库、SCHEMA、表名，详情可参考  4、其他查询比如 **即席查询** 、**SQL查询 、存储过程查询** 等转成 **ETL高级查询** 之后，在ETL 对应的是 **数据查询** 节点，  
所有查询都可以新建计算列，在模型中查询相当于一个视图、表的概念，新建计算列即在表中新建新列，详细可查看 创建计算列。  
1、即删除对应的查询；在模型中删除查询，如果不保存模型，是不生效的。 2、如果模型已经制作过报表或大屏，删除某个查询可能会影响前端的展现。 3、如果是抽取模式，删除查询需要重新抽取数据，详细可查看 直连&抽取。  
属性是查看该查询的来源；如果是【数据源表】可查看查询的节点ID、路径信息以及修改名词；如果是其他查询的属性，可以能修改查询名称、查看查询类型。  
# **3 查询设置**
选中关系视图的 **查询** ,在下方可设置 **字段属性** 、**预览数据** 、**抽取设置** ，(如果你想了解模型的界面区分可查看快速入门 ⬝ 界面介绍)。
## **3.1 字段属性**
为了更方便前端用户使用，所有查询类型都可以可以通过 **字段属性** 修改字段别名、数据格式等，其中：
别名长度限制：120字节(Varchar(120）)，相当于最多只能输入60个汉字。  
---  
在实际数据与数据类型不匹配情况下可以修改数据类型；比如字段在源表存储的是字符串类型，但是实际制作报表想要以数值型展现，那么在模型中设置成整型或浮点型；数据类型：字符串、整型、长整型、浮点型、长浮点型、日期、时间、日期时间、ASCII编码。
  * 数据模型暂不支持“BINARY”、“UNKNOWN”、“image”数据类型字段。
  * 如果数据模型来源于SQLserver，也不支持解析“text”、“ntext”。

  
如果某些字段从源表中拉取出来，发现是多余的，无需参与制作报表可以将其隐藏；隐藏之后就不会参与构建模型，比如新建计算度量，无法使用隐藏的字段参与计算。  
如果数据有安全要求，比如示例中的“订单编号”需要对部分用户脱敏，则可对该字段设置脱敏规则，脱敏规则需要先定义好并在这里设置引用，更多脱敏规则可参考：脱敏规则设置。  
如果需要把数据库中各字段的内容按需要转换为熟悉的业务术语，比如把“0”转成“男”，把“1”转成“女”，则可以对该字段设置转换规则，更多转换转换规则说明可参考：转换规则。  
在数据展示显示的格式，比如对金额显示多少位小数点等，如果默认的数据格式不是你想要的，可以参考数据格式增加更多格式。  
## **3.2 预览数据**
为了方便用户在制作模型的过程能快速能查看、校验数据, 只需要点击某个 **查询** 就可以直接查看输出的数据。
  * 预览数据面板只用于 **选中查询** 的数据预览。
  * 默认查询100条数据，用户可以输入具体的条数进行查看，最多只能查看1000条；如果是 **直连模式** ，预览数据是直接查询连接的业务库的数据； 如果是 **抽取模式** 则需要先抽取才能正常查看数据。
  * 如果数据更新了，可以点击 **刷新** 图标，刷新数据。
  * 显示别名：默认是勾选，即以字段别名查看数据；如果勾选去掉，则是以物理表中的字段名称查看数据。


## **3.3 抽取设置**
前置条件
只有数据模型是 **抽取模式** ，查询的”抽取设置“才能正常使用；直连模式是禁用状态。 
1、选中某个”查询“，在 **抽取设置** tab下可设置 **抽取方式** 、**抽取参数值** ，如下图：
  * **抽取方式** ：支持全量抽取、按次抽取。
  * **抽取参数值** ：查询定义的参数都会显示在这里，每个参数默认是以默认值进行抽取，也可以自定义值，详情可查阅直连&抽取。



  
