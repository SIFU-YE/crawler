
## 1 概述
事实表是一种数据表，数据表是由表名、表结构和表记录（表数据）等几部分组成。本文将介绍如何创建事实表的表名、表结构、表数据。
## 2 新建事实表的表结构
支持通过系统新建表、添加数据库的表和添加SQL查询三种方式创建事实表，三种方式的适用场景如下：
  * 系统新建表：无数据仓库，无数据治理，指标模型直接对接原始业务库时，可通过梳理指标和维度关系，帮助项目建立规范的维表和事实表。
  * 添加数据库的表：有数据仓库，有独立的数据治理团队，数据仓库中已梳理好了规范的维表和事实表。
  * 添加SQL查询：数据库中没有现成且满足要求的表，且又不希望再重新创建和维护新的表，则可使用SQL查询。


### 2.1 系统新建表
1、点击数据准备，进入已创建指标模型，选择 **存储管理** ，选择 **事实表** ，点击 **新建** ，系统支持三种方式新建事实表：根据指标新建、根据维度新建、手动新建。
####  2.1.1 根据指标新建
根据指标新建事实表前提：已经创建好全部或部分指标。使用根据指标新建事实表时，事实表自动包含选取的指标及指标依赖的维度。
1、在“选择指标”窗口，勾选指标：显示所有未被事实表关联的指标。
2、系统生成包含勾选指标及指标依赖维度的事实表，用户在此基础上创建其它指标及维度。
####  2.1.2 根据维度新建
根据维度新建事实表前提：已经创建好全部或部分维度。
使用根据维度新建事实表时，事实表自动包含选取的维度。
1、在“选择维度”窗口，勾选维度：
2、系统生成包含勾选维度的事实表，用户在此基础上创建其它指标及维度。
####  2.1.3 手动新建
若指标和维度都没有创建的情况下，通过手动新建事实表。手动新建的事实表是一个空白的表，需要用户手动添加指标和维度。
### 2.2 添加数据库的表
1、点击数据准备，进入已创建指标模型，选择 **存储管理** ，选择 **事实表** ，点击 **添加 > 数据源表 **。
2、进入到“添加数据源表”的界面，可批量从左侧添加多张表到右侧选框内。
  * 添加表的范围：指标存储库关联的数据源下的表、视图，指标存储库相关操作指导请查看章节。
  * 可添加多个Schema下的表、视图。
  * 在事实表中，同一张表、视图只支持添加1次。
  * 同一个表、视图支持在维表和事实表中分别导入。


### 2.3 添加SQL查询
1、点击数据准备，进入已创建指标模型，选择 **存储管理** ，选择 **事实表** ，点击 **添加 > SQL查询 **。
2、进入“新建SQL查询”界面，编写SQL后，点击工具栏上的 **保存** 。
3、将SQL查询结果作为事实表结构，输入名称后点击 **保存** ，完成事实表的创建。
4、由“SQL查询”新建的事实表，可通过 **编辑SQL查询** 更新事实表结构。
同个事实表中，不同的字段不可以关联同一个维度或同一个指标。
## 3 实现事实表的表数据
对事实表数据进行管理的方式有两种：在线编辑数据、通过绑定自助ETL实现灌数。
**在线编辑数据：** 在前端以Excel的形式提供在线编辑表数据的功能，适合业务或IT人员实现小批量数据的录入和修改。
**绑定自助ETL：** 通过ETL工具实现数据抽取、转换、加载，适合数据量较大并且对数据转换的要求比较高的情况，同时需要具备一定的ETL工具能力。
### 3.1 在线编辑数据
1、打开某个事实表，点击
2、点击右侧的**在线编辑**
● 目前暂时只支持小数据量的场景，默认限制表数据小于等于1000行时，才能进行在线编辑。
● 表格数据默认是至少显示100行，如果表数据本身没有达100行时，会自动在数据下面增加空行补齐。
表格列是根据当前事实表的字段自动显示，不支持增删列。
默认会自动是冻结列头。
由于SQL查询的数据结果，可能是通过SQL语句查询多个表而来，所以无法根据输出的字段在线编辑数据并回写入库，故SQL查询不支持在线编辑数据。
在线编辑数据界面各操作项说明如下：
操作项 | 说明 | 效果图  
---|---|---  
列头 （下拉菜单） | 列宽 |  打开时，表格默认列宽是根据窗口宽度自适应显示。 调整列宽的方法： 列头下拉更多菜单中，可以自定义调整当前列的列宽。 ● 手动拖拽列右边界线，调整列宽 自定义的列宽暂时不支持保存。  
行头/选中整行 （右键菜单） | 复制 |  支持复制一整行的数据后，粘贴到当前窗口、本地文件等。 ● 在线编辑数据窗口的粘贴功能，目前只支持 Ctrl + V  
向上增加 n 行 | 在当前选中行上方插入 n 行空白行。  
向下增加 n 行 | 在当前选中行下方插入 n 行空白行。  
删除选中行 | 删除当前选中行。  
行高 |  调整行高的方法： ● 行头右键菜单中，可以自定义调整当前行的行高。 ● 手动拖拽行下边界线，调整行高 自定义的行高暂时不支持保存。  
清除内容 | 清除当前选中行里的全部内容  
单元格 （右键菜单） | 复制 |  支持复制当前单元格数据后，粘贴到当前窗口、本地文件等。 ● 在线编辑数据窗口的粘贴功能，目前只支持 Ctrl + V  
插入行 | 在当前选中单元格上方插入一行空白行。  
删除选中行 | 删除当前选中单元格所在的行。  
清除内容 | 清除当前选中单元格的内容。  
其他操作 | 填充 | 按照类EXCEL的填充规则，自动填充单元格内容  
撤销回退 | 支持通过键盘的 Ctrl + Z 撤销上一步操作  
在线编辑的是指标存储库中的数据，此操作不会影响源业务系统的数据。指标存储库功能详见 指标存储管理
2、如果编辑的数据类型、是否为空等属性和原本表定义不一致、编辑的数据超过1000行等情况时，点击**确定** ，会自动进行保存校验。
### 3.2 绑定自助ETL
1、事实表未绑定自助ETL前：若已经创建了事实表灌数的自助ETL，则直接选择自助ETL绑定即可；若还未创建事实表灌数的自助ETL，则需要新建自助ETL实现绑定。
2、事实表已经绑定自助ETL：支持打开自助ETL进行修改、重新绑定自助ETL或解除绑定操作。
自助ETL的创建及设置详情请参见：自助ETL。  
