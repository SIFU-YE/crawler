
# 1 概述
可视化SQL查询可以提供简单的拖、拽操作，实现多张表联接（JOIN）、条件筛选、切换聚合方式等轻松构建模型。
原数据模型”即席查询“，在V11最新版本中更名为”可视化SQL查询“。
前置条件
1、可视化SQL查询支持直连、抽取模式； 详细可查阅：直连&抽取。
2、如果可视化SQL查询有参数，可参考参数设置进行参数映射。
3、可视化SQL查询基于业务主题、数据源进行分析。
# 2 示例说明
基于产品销售数据，业务人员希望可以通过简单拖、拉拽实现得到要分析的数据，详细操作可查看：入门视频。
基于上述要求，本次可视化SQL查询分析思路如下：
  * 展现输出字段：产品名称、单价、数量、销售额。
  * 区域、产品类别作为筛选条件。
  * 对单价、数量、销售额进行聚合。


示例最终效果如下图：
下面看具体的操作步骤: 建立模型，并且在模型中加入可视化SQL查询。
### **2.1 跨表取数**
1、首先需要**选择数据** ：选择产品自带northwind数据库下【产品表】【订单详情表】...。
**2、字段选择** ：如果要选择取数的字段，可以通过左侧树上勾选字段【产品名称】、【单价】、【数量】，可以跨表勾选，右侧列表区域会直接显示对应字段的数据。
**3、筛选条件** ：如果报表要添加筛选条件，可通过拖、拉、拽左侧字段到右侧列表**上面区域** ，并且生成的筛选条件可以通过 调整备选值以及 **修改条件关系（** 参考本文第3节第6点**）** ， 如下图从左侧拖入【发货区域】、【产品类别】到筛选条件上。
### 2.2 加工数据
通过前面三步，可视化SQL查询已初步构建好了，但是 **"销售额"="单价"*数量** 在源表上并不存在，这时就需要使用计算字段，构建出来：
1、入口：左侧资源树上的选中“计算字段”的右键菜单，选择“新建计算字段 ”。
2、表达式: 支持表、业务视图、函数、用户属性、字段、+、-、*、/。
4、新建好了计算字段，在右侧列表表头上可以**切换聚合方式，** 分别把单价、数量、销售额的聚合方式切成”合计值“。
### 2.3 生成宽表
根据以上步骤，示例分析要求都已做完，保存之后，在模型中会“生成一个大宽表“，如下图，可以通过右键菜单进行更多操作，详情可查看：设置及修改查询， 也可以设置与其他查询的关系、构建数据模型等。
# **3 其他补充说明**
1、勾选字段的快捷操作: 在资源树上选中某个表鼠标移上去可显示快捷方式如下图：
2、 条件显示设置: 可视化SQL查询支持条件面板是否显示的设置,默认是显示；如果不勾选则不显示出来。
3、报表设置：报表设置可对是否对获取总行数、数据去重等属性进行设置 ：
4.、获取总行数：在
5、参数设置: 可视化SQL查询中由拖拽字段生成的条件会自动生成参数，且参数默认是隐藏状态; 单击工具栏中的 **视图** 按钮，在弹出的下拉菜单中勾选或者勾除 **显示参数** ，实现设置参数面板的显示或隐藏。 
6.、筛选条件元素的说明如下：
条件对象 | 条件对象是字段条件的名称，当添加条件后，系统自动根据字段名称生成条件对象名称。  
---|---  
逻辑运算符 | 字符串型 |  条件对象的数据类型是字符串型时，支持匹配的运算符有：等于、不等于、开头为、结尾为、包含、不包含、大于、大于等于、小于、小于等于、为空、不为空、为空串、不为空串； 系统默认运算符为“等于”，默认控件类型为“列表对话框”。 当运算符为“为空”和“不为空”时，没有值域设置项。  
数值型 |  条件对象的数据类型是数值型时，支持匹配的运算符有：等于、不等于、大于、大于等于、小于、小于等于、为空、不为空。 系统默认运算符为“等于”，默认控件类型为“文本输入框”。 当运算符为“为空”和“不为空”时，没有值域设置项。  
日期型 |  条件对象的数据类型是日期型时，支持匹配的运算符有：等于、不等于、大于、大于等于、小于、小于等于、为空、不为空。 系统默认运算符为“等于”，默认控件类型为“日期控件”。 当运算符为“为空”和“不为空”时，没有值域设置项。  
值域设置项 | 选择条件的具体值，表格会根据选择的值对数据进行过滤，只显示选择的值所对应的数据。  
修改参数 |  修改参数（）：用于修改参数的部分属性，例如：条件表达式值域设置框的高、宽、控件类型、备选值、默认值等。 修改属性项的详情请参见 章节。  
删除条件 | 删除条件（）：用于删除当前条件表达式。  
修改条件关系  |  修改条件关系（）： **1、过滤条件：聚合方式为原始值的条件。** 当有两个及以上条件时，可以实现对条件之间的关系进行修改。 条件关系有AND和OR可供选择，系统默认的条件关系是AND。 修改方法如下图： **2、聚合条件：聚合方式为非原始值的条件。** 当有两个及以上条件时，可以实现对条件之间的关系进行修改。 条件关系有AND和OR可供选择，系统默认的条件关系是AND。 修改方法如下图：  
