
## 报表简介
交叉报表是分组报表的一种特殊情况，行列都呈现分组结构，交叉区域展现数据的一类报表。
**作用：** 用于多维度统计数据。
**适用场景：** 适用数据统计的情况。
**报表结构：** 交叉报表主要由有“列组+行组+交叉数据区”一种结构，如下图：


## 示例效果
下表是最常见的一类交叉报表：
本示例效果数据来源为模型查询。
若是希望使用旧数据集作为数据来源，则需更新授权包含旧数据集的License文件；若是希望使用关系数据源、透视分析、即席查询作为数据来源，则可以选择通过配置高级设置开启旧数据集面板，详情请参考 电子表格插件启用旧资源数据集
## 数据要求
定义如下模型查询进行交叉表的定制。
## 分析定制
该表结构简洁，数据清晰，具体的分析及实现详情如下：
方法或步骤  
---  
列头绑定字段 |  通过拖拽字段到单元格，将维度字段绑定在列头。 多个维度逐层分组，因此默认父格设置即可。 |  1、在“数据集面板”下分别拖拽字段“产品类别”、“产品名称”到单元格C2、C3；设置其扩展方向为“从左到右” 2、列头样式：字体：黑体；字号：10；字体颜色：黑色；填充色：#DAEEF3。  
行头绑定字段 |  通过拖拽字段到单元格，将维度字段绑定在行头。 多个维度逐层分组，因此默认父格设置即可。 |  1、在“数据集面板”下分别拖拽字段“销售区域”、“销售城市”到单元格A4、B4； 2、行头样式：字体：黑体；字号：10；字体颜色：黑色；填充色：#DAEEF3。  
拖拽数值字段（度量字段）进行汇总合计显示。 交叉数据区采用默认父格设置即可，其数据计算是根据默认上父格和默认左父格进行分组汇总。 |  1、在“数据集面板”下拖拽字段“销售额”到单元格C4； 2、选中单元格C4，在工具栏设置：扩展方向为“不扩展”，数据设置为“汇总”，汇总为“求和”： 若电子表格的数据来源是基于数据模型创建的模型查询，如需修改汇总方式，需前往数据模型的汇总依据中进行设置，详情可参考数据模型-度量面板 3、数据区样式：字体：黑体；字号：10；字体颜色：黑色；填充色：#FFEB9C；  
交叉表头设计 |  主要有两种方法进行设置： 1、利用Excel的工具。 2、利用Smartbi的工具。 |  1、利用Excel的工具设计：通过 **插入** 菜单下的**形状 > 文字、 斜线 **工具进行设计： 其中，文字不带边框。 设计界面如下： 浏览效果如下： 2、利用Smartbi的工具设计：通过Smartbi中的 **格式 > 斜线** 工具进行设计： 设计界面如下： 其中，行头名称写在分隔线前，列头名称写在分隔线后。 浏览效果如下： 3、交叉表头填充色：#FFEB9C；  
设置销售数据中，异常数据的告警显示。 |  1、设置入口：Excel的 **开始** 菜单下的工具 **条件格式 > 突出显示单元格规则**： 2、“1<=销售数据且<=200”的告警设置： 3、“销售数据>1500”的告警设置：  
主要是表格边框线条的设置。 | 边框颜色：#C4BD97；边框大小：1px；线型：实线；  
标题直接在电子表格中输入标题名称“各区产品销售情况”，设置字体、大小、颜色、居中对齐。 | 标题字体：黑体；字号：12；字体颜色：#203764；  
小计 | 添加分组小计 |  1、合并单元格“C2”和“D2”，“A4”和“A5”。 2、在单元格“D3”、“B5”上标注填入文字“小计”， 3、单元格 “D4”、“C5” 内输入公式 “=SUM(C4)”；单元格 “D5” 内输入公式 “=SUM(D4)”； 4、设置单元格 “B5 : C5”、“D3 : D5” 的单元格颜色为：#EDEDED（237,237,237）；  
结果集筛选 | 对产品类别、销售城市只显示前3项，对产品名称只显示前2项 |  1）选中单元格“C2”，在 “Smartbi” 工具栏下单击“属性”设置单元格属性，切换到页签“其他”下，设置结果集筛选前3个。 （2）选中单元格“C3”，其余操作同上，设置结果集筛选前2个； （3）选中单元格“B4”，其余操作同上，设置结果集筛选前3个。  
数据为空时显示为0 | 当数据为空时用0替代 |  双击选中单元格“C4”，打开其单元格属性界面，勾选数据设置下的“数据为空时显示为零”。  
完成以上定制后，保存即可。
## 注意事项
1、交叉表头两种实现方式的对比：
  * Excel 工具实现的交叉表头，样式上更灵活些，可以设置斜线的颜色、字体大小颜色等，有所见即所得的效果，但操作上会复杂些。
  * Smartbi 工具实现的交叉表头，操作更便捷些，但格式固定。

  
