
## 功能简介
填报报表是指用户在报表端可以直接增加、删除数据记录的一种报表功能，同时填报的数据亦能用于数据查询。
**作用：** 用于在报表端进行数据补录或回写。
**适用场景：** 适用数据补录或回写填报的业务需求。


## 实现原理
填报，我们也可以说是回写，是指用户从浏览端中录入数据，然后保存到指定数据库的表中。我们将保存这些录入数据的库称为回写库，将表称为回写表。
在定义好浏览端录入表与回写库中回写表的关联关系（包含主键）后，按照如下规则进行回写：
  * 当该数据以主键为搜索条件在回写表中不存在时，通过“insert"语句将该数据写入回写表中。例如：insert into 表名（字段1，字段2，字段3） values（字段1的值、字段2的值，字段3的值）……Where 主键字段1=值1，主键字段2=值2……


  * 当该数据以主键为搜索条件在回写表中已经存在，通过“update”语句将最新数据更新到回写表中。例如：update 表名 set 字段1=字段1的值，字段2=字段2的值……Where主键字段1=值1，主键字段2=值2……


## 示例效果
下面以一个表单回写填报为例演示效果：
## 分析定制
该报表功能的实现详情如下：
定制填报表样 |  1、单元格B2输入“填报人：”，单元格D2输入“填报日期”，设置样式：字体“黑体加粗”，字号“11”，字体颜色“黑色”，居左显示； 2、单元格B3输入“姓名：”，单元格B4输入“手机：”，单元格B5输入“性别：”，单元格B6输入“部门：”，单元格D3输入“年龄：”，单元格D4输入“邮箱：”，单元格D5输入“入职年限：”，单元格D6输入“薪资（年薪）：”，单元格D7输入“文件名称：”，设置样式：字体“黑体加粗”，字号“11”，字体颜色“黑色”，居中显示； 3、调整行宽、列高，选择单元格区域“B3：E7”设置边框颜色为“#305496”，边框大小为“1px”； 4、设置标题  
---|---  
设置填报信息 |  1、在单元格C2中输入Smartbi函数：=SSR_GetCurrentUserAlias() 2、在单元格E2中输入Excel函数：=TODAY() 函数详情请参见 电子表格⬝ 计算函数 章节。  
连接回写库、回写表 |  1、通过 **关系数据源连接** 功能，连接回写库：  
设置回写规则 |  回写规则实现的是将填报报表中的字段与回写表中的字段建立对应关系。 1、在Smartbi工具栏中单击 **回写规则** ，弹出“回写规则设置”窗口，按照如下要求进行回写规则设置：  
设填报属性 |  填报属性的设置用于实现在浏览端报表的录入以及控制录入内容的规范。 1、选择允许录入的单元格，在Smartbi工具栏中单击 **填报属性** ，弹出“单元填报属性”窗口，按照如下要求进行填报属性设置： | 单元格C4、E4 |  手机和邮箱也是“单行文本”，但是需要设置正则表达式来规范输入的内容：  
---|---  
单元格C5、C6、E5、E6 |  性别、入职年限、部门、薪资（年薪）四项通过绑定参数实现在浏览端中选择录入值： 参数设置详情参考 关系数据源参数 章节，其中“性别”参数控件是“平铺勾选面板”类型，其它三个参数是“下拉框”类型。  
“单元格填报属性”窗口的各设置项详情请参见 电子表格⬝ 填报属性 章节。  
完成以上设置保存即可。
## 回写应用
填报回写是电子表格很强大的一项功能，以上的示例只是展现了该功能最基本的部分，除此之外填报回写在实际业务中有很丰富的应用。
## 示例资源
1
2、报表资源：填报报表.xml  
