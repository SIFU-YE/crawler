
# 1 案例背景
某食品销售公司，业务分析师需在每个季度末都要对全国的产品总体销售情况进行汇总及同期对比分析，并上报给相关管理层辅助决策，具体需要满足如下要求：
  * 可以快捷查询不同年份、不同季度的销售数据
  * 需要计算出所有食品的总销售收入
  * 需要各产品的销售额占比和同期比计算
  * 管理层比较关注东北区的销售数据，因此最好对该区域有排序情况
  * 对所有业绩好的和市场份额较差的产品都要予以告警显示
  * 从易用和美观角度出发，还要进行表格样式、数据格式、列头行头字体等效果的调整


# 2 需求分析
数据开发组已针对销售主题制作“订单模型”，并且授权给业务分析师使用，基于该数据模型，结合以上销售数据的分析需求，对上面所描述的需求进行如下分析：
  * 展现的输出字段：产品类别、产品名称、发货地区、销售额；过滤条件字段：订单日期时间维中的订单年份和订单季度
  * 按照产品类别和产品名称对销售数据进行小计合计值计算
  * 对销售额进行占比和同期比计算
  * 报表上只保留东北区域的数据，然后对其销售额降序排列
  * 对销售额数据设置数据预警
  * 从报表美观等角度进行的一些报表其它设计：数据格式、行头、列头字体，列头宽度等


# 3 示例效果
# 4 实现步骤
## 4.1 新建透视分析
登录系统后，在 **分析展现** 界面，鼠标点击 **透视分析** 新建透视分析报表。
## 4.2 选择及过滤数据
进入透视分析界面后，从右侧的数据面板点击 **选择业务数据集** ，选择产品demo中的“订单模型”。通过鼠标勾选/拖拽的方式，将“产品类别”和“产品名称”放在“行区”、“发货区域”放在“列区、”销售额“字段放在度量区、”订单年份“放在”过滤条件区，并且设置其过滤条件值为“2021”。
关于数据过滤的更多介绍可查看透视分析 ⬝ 数据过滤。
## 4.3 数据分析
### 4.3.1 数据汇总
在“产品类别”和“产品名称”字段上右键选择 **分类汇总 > 显示** ，可查看所有产品销售额的小计合计数据。
同样也可以在列区的“发货区域”字段上设置显示分类汇总，查看每种产品在全国总的销售额。更多详情可查看透视分析 ⬝ 分类汇总。
### 4.3.2 占比分析
在“销售额”字段上右键选择 **快速计算 > 占比 > 组内占比** ，计算每种产品在当前区域所属产品类别销售额的占比；在“销售额”字段上右键选择 **快速计算 > 占比 > 全局占比** ，计算每种产品在当前区域总销售额的占比。
如下图”东北“区域的”运动饮料“销售额组内占比为1461.60/8894.20≈16.43%；”东北“区域的”运动饮料“销售额全局占比为1461.60/56586.00≈2.58%。
关于占比的更多介绍可查看透视分析⬝ 排名和占比。
### 4.3.3 同期值分析
在“销售额”字段上右键选择 **快速计算 > 同期 > 同期值** ，计算每种产品的同期值数据。
上图中”饼干“在”2021年“”东北区域“的销售额同期值是其在”2020“年的销售额，可以过滤条件的值切换为”2020“核对数据的准确性。
关于同期值的更多介绍可查看透视分析 ⬝ 同期。
### 4.3.4 数据过滤
如果在分析数据时想聚焦到“东北”区域的销售数据，那么可以在“东北”字段上右键选择 **过滤 > 只保留 **，若再想查看所有区域的数据，可以在“东北”字段上右键选择 **清除过滤** 。
## 4.4 报表设计
### 4.4.1 数据排序
在“销售额”字段上右键选择 **排序方式 > 组内降序** ，将每种产品按照销售额降序排列查看。
关于排序更多介绍可查看透视分析字段排序
### 4.4.2 数据预警
对销售额的组内占比大于40%或全局占比大于10%的产品，代表是比较畅销的，需要凸显出来考虑加大生产量。在 **设置 > 属性 > 条件格式 **中对“销售额(全局占比)”和“销售额(组内占比)”设置数据预警，设置如下：
关于数据预警的更多介绍可查看透视分析 ⬝ 设置样式。
### 4.4.3 数据格式
对“销售额”可以通过 **数据格式** 将其设置为“万元”为单位。
关于数据格式的更多介绍可查看分析数据 ⬝ 数据格式。
### 4.4.5 表格设置
数据表格的风格样式可以根据个人喜欢在 **设置 > 属性 > 表格 **中对其“列宽”、“风格”、“颜色”等自定义设置。
关于表格设置的更多介绍可查看透视分析 ⬝ 设置样式。  
