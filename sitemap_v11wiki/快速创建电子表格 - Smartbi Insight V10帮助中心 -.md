


在分析展现模块，若您想通过报表的形式，使用Excel的函数、条件格式等常用功能对数据进行分析；您需要入门电子表格；本文将用内置的“产品信息数据集”，生成模型查询，给您介绍如何**基于模型查询** 快速创建电子表格。
## 1、示例描述
公司领导想通过中国式报表来对近两年各类产品销售情况进行分析：
  * 可按需查看不同的产品类别
  * 可分析产品各月销售额的前期值、环比、占比、累计值以及总排名
  * 按年对各月的指标进行小计


......
基于上述需求，通过分组报表进行分析，效果如下图所示：
## 2、入口及界面
  * ### Excel插件安装


安装电子表格插件**SmartbiExcelAddin10.1** ，插件详情介绍可参考文档电子表格-Excel插件。
（1）插件安装完成后打开电子表格。
（2）在Excel工具栏中选择Smartbi，点击设置按钮后进行登录设置。
输入相关服务器配置信息：
（**下述值仅供参考** ）
服务器URL | 服务器URL为服务器的访问地址 | http://localhost:18080/smartbi  
---|---|---  
用户名 | 当前服务器地址的用户名 | admin  
密码 | 当前服务器地址的密码 | admin  
（3）登录成功后，电子表格设计器界面如下：
## 3、操作步骤
### 新建模型查询
（1）数据集面板点击“+”，选择新建模型查询：
（2）模型查询界面，数据来源前往：**数据集 >功能演示**，选择产品内置数据模型：订单模型；
（3）完成选择后，维度、指标区如下图所示：
（4）订单日期时间维下，勾选订单年份、订单年月，度量勾选销售额；
（5）销售额点击更多，选择快速计算>前期>前期值计算：
（6）参照（5）方法，在依次对销售额进行环比计算、占比计算、累计值计算和总排名计算，效果如下图所示：
（7）分别点击相关快速计算后的字段，进行位置调整：
（8）展开产品类别表，拖入产品类别至过滤区：
（9）完成新建模型查询后，点击保存，名称为：产品信息
（10）保存后，数据集面板可看到模型查询相关字段
### 制作表头
在电子表格中输入表名“近两年销售指标统计”，列名“年”、“月”、“销售额“、前期值”、“环比”、“占比”、“累计值”和“总排名”，表头效果如下图所示：
### 引用字段
将右侧数据集面板字段，依次拖入到表格中：
### 小计合计
（1）选中单元格D6，输入公式：=SUM(D5)
其余单元格E6、F6、G6、H6同上依次输入SUM公式
（2）选中单元格D7，输入公式：=SUM（D6）
其余单元格E6、F6、G6、H6同上依次输入SUM公式
### 参数管理
（1）电子表格菜单栏点击参数管理
（2）参数管理界面点击自动生成参数
（3）映射后，参数界面作如下设置：
数据类型 | 字符串  
---|---  
控件类型 | 下拉（单选）  
数据源 | northwind  
默认值 |  静态列表
  * 真实值：饮料
  * 显示值：饮料

  
备选值 |  SQL：select distinct CategoryName from categories
  * 真实值：CategoryName
  * 显示值：CategoryName

  
（4）选中合并单元格B2-D2，工具栏点击引用参数：
（5）引用参数值：产品类别；确认后，效果如下图所示：
## 4、发布预览
（1）工具栏点击发布，名称为：基于模型查询快速创建电子表格
服务器相关路径下也可查看所发布的报表
（2）发布完成后，工具栏点击预览，即可查看相关效果；
至此，使用模型查询创建的电子表格已完成，接下来您可以参考资源发布快速入门，发布您创建好的报表资源
## 5、资源参考
（1）上述快速创建电子表格的示例资源，可参考快速创建电子表格.xml
（2）若您想深入了解电子表格相关内容，可参考以下文档：
  * 电子表格更多示例可参考电子表格⬝ 报表应用

  
