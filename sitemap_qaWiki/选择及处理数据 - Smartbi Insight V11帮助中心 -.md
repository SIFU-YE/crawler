
# 1 概述
数据分析的前提是要有可分析的数据，本文将介绍透视分析如何选择数据以及进行汇总、排序、数据格式等操作。
# 2 功能入口
在”分析展现“界面选择”透视分析“打开创建报表的界面，从右侧的数据面板点击 **选择业务数据集** 。
  * 透视分析支持仅支持 **数据模型** 做为数据集
  * 数据集较多时，可通过上方的搜索栏快速查找定位，支持通过 **资源名称** 、 **资源ID** 和 **资源描述** 搜索，搜到的资源可双击或点击确定按钮选择
  * 数据集选择的范围可以从 **最近访问** 中快速查找


# 3 详细介绍
## 3.1 字段查找
1、搜索
当业务数据集中内容比较多，查找所需字段会比较困难，可通过搜索快速找到相关字段。搜索范围包含：维度、度量、命名集和参数。
  * 在数据选择区中点击 ，在搜索框中输入关键字，系统将自动根据关键字筛选并展示搜索结果
  * 点击 ，可清空搜索关键字，返回搜索前的内容


2、维度和度量关联筛选
业务数据集中维度和度量较多，且有些维度和度量之间没有关联关系时，可使用维度和度量的关联筛选功能，帮助用户快速理清维度和度量间的联系，保证查询数据的质量。
（1）以产品内置Demo资源的“订单模型”为例，产品指标分类下的“库存”仅和“产品表”维度有关系，和顾客、发货区域、订单等维度没有关系。若没有如下图的维度和度量关系表，用户想要分析各产品当前的库存情况时，容易选择到无关联的维度，导致查询出来的数据全部相同，大大增加了分析数据的难度。
（2）此时可以选择开启维度和度量之间的关联筛选功能，勾选想要分析的维度或度量，查看维度和度量之间是否有关联关系，保证查询数据的质量。有两种筛选的方式，具体效果如下：
  * 通过度量去关联筛选维度：点击**开启度量和维度关联筛选** 后，勾选所需度量，可快速筛选出和该度量有关联关系的维度。


  * 通过维度去关联筛选度量：点击**开启维度和度量的关联筛选**


从上述维度和度量的关系表可知，“产品表”维度和“运费”、“订单量”度量无关联关系，勾选“产品名称”去关联筛选度量时，会自动过滤掉“运费”和“订单量”这两个度量。
3、维度和度量之间的关联筛选，当前只支持单向筛选，即只能勾选维度筛选度量，或者勾选度量筛选维度。关闭关联筛选，列表可回到全显示状态。
4、维度和度量之间的关联关系是通过数据模型表关联关系来判断，数据模型表关联关系功能可参考文档 数据模型-表关系区
5、勾选不同维度或不同度量时，关联筛选的结果是取所有维度或度量共同关联的部分，即取交集。
比如“库存”度量仅关联“产品表”维度，“销售额”度量关联“产品表”、“发货区域”、“订单日期维”等维度，开启了度量和维度关联筛选后，同时勾选了“库存”和“销售额”，筛选后的结果只取“产品表”维度。
## 3.2 字段选择
透视分析上可以通过鼠标勾选/拖拽的方式选择要分析的字段，若要去掉已选中字段，可通过鼠标勾除或点击。
1、行区&列区字段选择：
  * **行区** 和 **列区** 可以拖拽 **维度、命名集** 目录下面的字段，并且可以点击一键行列互换


2、度量区字段选择：
  * 模型上的 **度量区** 只能拖拽 **度量** 字段
  * 度量字段分为普通度量字段和计算度量字段。普通的度量字段可以修改汇总依据，当修改其汇总依据时系统自动在”计算度量“目录下生成一个新的度量字段，该度量字段属于此报表私有，原数据模型上的汇总依据不会受影响；计算度量其汇总依据是由引用的度量字段决定，所以不支持修改其汇总依据。


  * 若需将 **维度** 字段放在 **度量区** ，可先在维度字段上右键选择 **复制转度量** ，对于转换的度量字段放在“自定义度量”目录下，支持修改其 。如以产品demo中的订单模型为例，统计各区域的订单个数，可以先将“订单编号”字段复制转度量，然后修改其汇总依据为“计数”实现。


  * 添加了度量字段后，在列区会虚拟出一个 字段，它主要用于交叉表时显示度量字段的名称以及调整度量字段的位置。


3、批量勾选字段
在目录上右键或者点击目录的菜单，在弹出的菜单中点击全选子节点、全选子孙节点等菜单，可以实现字段的批量勾选/反选，提高数据查询的效率。
透视分析功能逻辑和仪表盘的交叉表组件一样，更多数据处理功能详见：数据分组、创建计算列、创建计算度量、创建命名集、复制转度量、复制转维度。
## 3.3 字段操作
### 3.3.1 排序
如果查出来的原始数据杂乱无序的，那么可以通过排功能将数据按某一特定规则进行排列，以便更清楚地查看分析数据。
支持在字段和表头上支持设置排序，透视分析的排序逻辑和交互式仪表盘的交叉表组件一致，排序逻辑详见：数据排序逻辑。
### 3.3.2 数据格式
数据格式是于设置前端数据显示的格式类型，比如把日期数据显示为特定的日期格式，在数据后面添加单位“万元”等。
1、场景示例：将“销售额”字段设置为”万“的数据格式
在度量区的 “销售额”字段上，点击选择
关于数据格式详情，可查看文档分析数据 ⬝ 数据格式
2、注意事项：
  * 透视分析上设置的数据格式仅用于前端展示，不支持报表导出
  * 透视分析上设置的数据格式为该组件私有且优先级高于公共数据格式
  * 数据格式为“自动”表示默认使用数据集自身设置的数据格式，透视分析不做数据格式处理
  * 若字段使用了转换规则，则以转换规则为先，数据格式不失效


### 3.3.3 设置显示名
数据模型中定义的字段名称有时可能不够清晰直观，那么在透视分析上可以通过 **设置显示名** 来自定义字段显示名称
场景示例：报表上已把单价的”汇总依据“修改为”平均值“，因为需要将其显示名称改为”平均单价“
在度量区的 “单价”字段上，点击选择**设置显示名** 设置字段显示名称  
