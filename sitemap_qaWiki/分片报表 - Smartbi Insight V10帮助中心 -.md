
## 报表简介
分片报表，是指在报表中通过一个或多个表格展现单源或多源数据的一类报表。
**作用：** 用于多维度统计数据。
**适用场景：** 适用多源数据展现。
**报表布局：** 分片报表的表格布局没有规律，根据实际业务需求进行规划。
  *     *     * 

## 示例效果
以下列出了分片报表的几种示例效果：
示例1：同表格中数据左右分片 |  该分片报表，虽然展示的是一个表格，但是隐含了两个表格的信息：分别按照区域和月份统计不同产品类别下的产品销售额情况。 由于统计的都是相同的对象“产品”，且产品信息在该报表中位于行头位置，在产品的基础上再分别综合区域和月份进行数据统计，表格结构基本一致，属于交叉分组类，因此我们将区域和月份的数据按照不同的数据区块处理，且以左右分片的形式展现，加以一些样式设计，便得到当前示例效果。 该示例实现步骤请参考 同表格中数据左右分片。  
---|---  
示例2：同表格中数据上下分片 |  该分片报表，形式上是一个表格，但是也显示了两个数据区块的内容：从时间角度和从区域角度进行的销售数据统计，呈上下分片无缝衔接的形式，这两个数据区块共用列头，加上表格样式设计实现示例效果。 该示例实现步骤请参考 同表格中数据上下分片。  
示例3：不同表格左右分片 |  该分片报表，以两个独立表格的形式展现不同维度的销售数据。 该示例实现步骤请参考 不同表格左右分片。  
本示例效果数据来源为模型查询。
若是希望使用旧数据集作为数据来源，则需更新授权包含旧数据集的License文件；若是希望使用关系数据源、透视分析、即席查询作为数据来源，则可以选择通过配置高级设置开启旧数据集面板，详情请参考 电子表格插件启用旧资源数据集
## 数据要求
分片报表有不同的数据区块， 这些数据可以来源同一个数据结果集，也可以来源不同的数据结果集。
本章节以一个模型查询进行定制示范，来源不同的数据结果集的分片报表示例详情请参见 多数据集报表 章节。
定义如下模型查询：
## 分析定制
三种不同类型的分片报表实现的详情如下：
### 1. 同表格中数据左右分片
设置表格中的固定内容：
  * 按区域统计
  * 按月份统计

|  1、在单元格D3中输入“按区域统计”； 2、在单元格F3中输入“按月份统计”； 3、设置样式：字体“黑体”、字号“10”、字体颜色“#2F5597”，居中显示；  
---|---  
设置交叉表头 |  1、合并单元格“B3：C4”； 2、选择该合并单元格，通过Smartbi工具栏的 **格式 > 斜线**，设置交叉表头： 3、在“斜线”窗口的文本框中输入如下内容： 4、设置样式：字体“黑体”、字号“12”、字体颜色“#2F5597”，居中显示；  
拖拽字段 |  1、字段“产品类别”拖拽到单元格B5； 2、字段“产品名称”拖拽到单元格C5； 3、字段“发货区域”拖拽到单元格D4； 4、字段“月”拖拽到单元格F4； 5、字段“销售额”拖拽两次，分别到单元格D5和F5； 6、设置样式：
  *     * 单元格B5：字体“黑体”，字号“10”，字体颜色“#2F5597”，居中显示；
    * 单元格D4、F4：字体“黑体”，字号“10”，字体颜色“白色”，填充色“#2F5597”，居中显示；
    * 单元格C5、D5、F5：字体“黑体”，字号“10”，字体颜色“黑色”，居中显示；

  
定义相关属性：扩展属性、数据设置、附属属性 |  1、单元格B5、C5：从上到下扩展，分组显示，父格默认； 2、单元D4、F4：从左到右扩展，分组显示，父格默认； 3、单元格D5、F5：不扩展，汇总求和显示，父格默认； 若电子表格的数据来源是基于数据模型创建的模型查询，如需修改汇总方式，需前往数据模型的汇总依据中进行设置，详情可参考数据模型-度量面板  
设置表格边框，行高列宽调整 |  1、按照示例设置边框，边框颜色为“#2F5597”，并调整行高列宽； 2、设计标题；  
完成以上定制后，保存即可。
### 2. 同表格中数据上下分片
定制列头 |  1、单元格D1中输入“销售额（元）”； 2、单元格E1中输入“销售量”； 3、设置样式：字体“黑体”，字号“10”，字体颜色“白色”，填充色“#2F5597”，居中显示；  
---|---  
定制交叉表头 |  1、合并单元格“B1：C1”； 2、选择该合并单元格，通过Smartbi工具栏的 **格式 > 斜线**，设置交叉表头： 3、设置样式：字体“黑体”，字号“10”，字体颜色“白色”，填充色“#2F5597”，居左显示；  
拖拽字段 |  1、字段“年”拖拽到单元格B3； 2、字段“月”拖拽到单元格C3； 3、合并单元格“B4：C4”，字段“销售区域”拖拽到该合并单元格； 4、字段“销售额”拖拽两次，分别到单元格D3、D4； 5、字段“销售量”拖拽两次，分别到单元格E3、 E4； 6、设置样式：
  *     * 字体“黑体”，字号“10”，字体颜色“黑色”，居中显示；
    * 单元格“B3：E3”填充色：#CCFFCC；
    * 单元格“B4：E4”填充色：#FFF2CC；

  
定义相关属性：扩展属性、数据设置、附属属性 |  1、单元格D3、D4、E3、E4：不扩展，汇总求和显示，父格默认；； 2、其它单元格不需要修改，保持系统默认即可；  
设置表格边框，行高列宽调整 |  1、按照示例设置边框，边框颜色为“#D9D9D9”，并调整行高列宽； 2、设计标题；  
完成以上定制后，保存即可。
### 3. 不同表格左右分片
左右分片的报表，由于左右两侧的表格存在共同的表格行，因此为了避免相互的影响，可以通过“数据覆盖”或“数据区域”的方式来实现。
定制列头 |  1、在右侧数据集面板中通过Ctrl或Shift键批量选择字段“销售区域”、“销售额”、“销售量”，并拖拽到单元格B3，在弹出的菜单中选择 **插入名称 > 从左到右**； 2、再批量选择字段“年”、“月”、“销售额”、“销售量”，并拖拽到单元格F3，在弹出的菜单中选择 **插入名称 > 从左到右**； 3、设置样式：
  *     * 字体“黑体”，字号“10”，字体颜色“白色”，居中显示；
    * 单元格区域“B3：D3”填充色：#66ABB3；
    * 单元格区域“F3：I3”填充色：#A9D18E；

  
---|---  
拖拽字段 |  1、在右侧数据集面板中通过Ctrl或Shift键批量选择字段“销售区域”、“销售额”、“销售量”，并拖拽到单元格B4，在弹出的菜单中选择 **从左到右** ； 2、批量选择字段“年”、“月”、“销售额”、“销售量”，并拖拽到单元格F4，在弹出的菜单中选择 **从左到右** ； 3、设置样式：
  *     * 字体“黑体”，字号“10”，字体颜色“黑色”，居中显示；
    * 单元格区域“B4：D4”填充色：#CFE3E7；
    * 单元格区域“F4：I4" 填充色：# E2F0D9；

  
设置相关属性：扩展属性、数据设置、附属属性 |  1、单元格C4、D4、I4、J4：不扩展，汇总求和显示，父格默认； 2、单元格F4：左父格“无”，其它设置项保持默认； 2、其它单元格不需要修改，保持系统默认即可； 由于两个表格间没有数据关系，因此单元格F4应该把默认项改成“无”，以避免F4单元格随其默认左父格B4而扩展，导致数据有误。  
设置数据填充方式 |  由于左右两个表格的字段行、分组等完全不同，但两个表格又有共用的行，若选用“插入”式数据扩展方式，左侧表格的扩展会影响右侧表格效果，因此：
  *     * 方案一修改数据填充方式为“覆盖”，保证表格行是固定的，不是扩展的，然后再将数据填充到这些固定的行中；
    * 方案二在数据填充方式为“插入”时，通过指定数据区域，在将左右两侧表格的数据区间的影响清除，以保证数据扩展效果正确。

通过数据覆盖方式实现的具体操作 1、分别选中单元格B4、F4，设置数据填充方式为：**覆盖** ； 2、其它单元格的数据扩展方式不需要修改，保持系统默认即可； 通过定义数据区域实现的具体操作 1、在Smartbi工具栏中单击 **区域** ，弹出“数据区设置”窗口； 2、单击 **添加** 按钮，弹出“选择单元格”窗口； 3、鼠标在报表设计器中批量选择单元格“B4：D4"； 4、按照步骤2和3批量选择单元格“F4：I4"； 5、单击 **确定** 后，返回“数据区设置”窗口，单击该窗口中的**确定** 按钮即可。  
设置表格边框，行高列宽调整 | 1、按照示例设置边框，边框颜色为“白色”，并调整行高列宽；2、设计标题；  
完成以上定制后，保存即可。  
