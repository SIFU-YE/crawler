
## 报表简介
分组报表是以分组表结构展现数据的一类报表，单元格间的逻辑关系较之清单报表复杂。
**作用：** 用于分组分级记录或查询数据。
**适用场景：** 适用数据记录、查询的情况。
**报表结构：** 分组报表主要由有“列头+分组区+数据区”和“行头+分组区+数据区”两种结构，如下图： 


## 示例效果
下表是最常见的一类分组报表：
本示例效果数据来源为模型查询。
若是希望使用旧数据集作为数据来源，则需更新授权包含旧数据集的License文件；若是希望使用关系数据源、透视分析、即席查询作为数据来源，则可以选择通过配置高级设置开启旧数据集面板，详情请参考 电子表格插件启用旧资源数据集
## 数据要求
定义如下模型查询进行分组报表定制。
模型查询的创建可参考文档 电子表格-模型查询
## 分析定制
该表结构简洁，数据清晰，具体的分析及实现详情如下：
方法或步骤  
---  
报表类型 | 设置报表类型为“分组报表” |  1、在服务器设置中选择分组表 2、在页面设置报表类型中选择分组报表  
列头 |  有两种方式定制列头字段： 1、手工输入列头。 2、系统自动获取字段名称定制列头，并设置列头样式。 |  1、系统自动获取列头名称的方法如下： 在“数据集面板”中通过Ctrl或Shift键依次批量选中字段，拖拽这些字段到列头第一个单元格处（此处为单元格C3），弹出右键菜单，选择 **插入名称 > 从左到右**。 该选择方式必须保证数据集输出字段与当前报表列头字段顺序一致。 2、列头样式：字体：黑体；字号：11；字体颜色：白色；填充色：#2F5597。  
绑定字段 | 将字段与电子表格单元格进行绑定。 |  在“数据集面板”相应的数据集下通过Ctrl或Shift键选择字段，拖拽到单元格C4，弹出右键菜单，选择 **从左到右** 。  
分组区 |  设置字段“销售区域”、“销售城市”、“产品”逐层分组。 通过系统默认的父格设置即实现逐层分组，因此当前报表定制不需要自定义父格。 |  选中单元格C4、D4、E4，在工具栏设置：扩展方向为“从上到下”，数据设置为“分组”：  
数据区 |  设置字段“销售额”、“销售量”中的数据进行汇总合计显示。 |  选中单元格F4、G4，在工具栏设置：扩展方向为“不扩展”，数据设置为“汇总”，汇总为“求和”： 基于数据模型创建的电子表格，如需修改汇总方式，需前往数据模型的汇总依据中进行设置，详情可参考数据模型-度量面板  
筛选 |  （1）设置“产品”字段的结果集筛选，只输出前3个； （2）设置“销售城市”字段的结果集筛选，只输出前两个。 |  （1）选中单元格“E4”，在“Smartbi”工具栏下单击“属性”设置单元格属性，切换到页签“其他”下，设置结果集筛选前3个。 （2）选中单元格“D4”，其余操作同上，设置结果集筛选前2个。  
表格样式 | 分别设置表格中分组区和数据区的填充色。 |  分组区背景色：选中单元格C4、D4、E4，设置填充色为#F2F2F2； 数据区背景色：选中单元格F4、G4，设置填充色为#FAFAFA；  
标题 | 标题直接在电子表格中输入标题名称，设置字体、大小、颜色、居中对齐。 | 标题字体：黑体；字号：12；字体颜色：#203764；  
完成以上定制后，保存即可。
## 资源下载  
