
  *   *   * 

过滤用于对数据列字段的结果集筛选，它是对数据集对应的结果集进行筛选。
只有数据列字段才可以进行过滤设置。
过滤是影响电子表格返回结果的重要因素，主要作用如下：
1、指定返回的结果，如指定只返回“区域等于‘华北’”的结果，则报表结果只显示“区域等于‘华北’”的数据。
2、指定多个业务查询间数据列的关联关系，实现跨数据集和跨数据源查询。如当电子表格数据列来源于两个业务查询时，通过这两个业务查询中字段的关联关系，返回其交集。
## 2、功能入口
1、选中数据列字段所在单元格，点击工具栏的 **过滤** 按钮，如图：
2、选中数据列字段所在单元格，点击工具栏的 **属性** 按钮，弹出“单元格属性”界面，选择“过滤”页签，如图：
3、双击数据列所在单元格，弹出“单元格属性”界面，选择“过滤”页签。
## 3、界面介绍
“过滤属性设置”界面如图：
各设置项说明如下：
父格条件 | 将父格值作为过滤条件 |  父格条件主要用于设置子格是否依据父格进行过滤。 该设置项适合于父子格自于同一个数据集。 示例：同一个数据集的“发货区域”和“发货城市”存在父子格关系，如图： | 勾选父格条件 | 勾除父格条件  
---|---  
“发货城市”的值依据其所属“发货区域”进行过滤。 |  “发货城市”的值不依据其所属“发货区域”进行过滤，每个区域显示所有城市。  
值 | 值过滤是指通过设置数据列的值过滤出相应的数据，详情请参考 值过滤。  
参数 | 参数过滤是指通过设置数据列的值与参数值的关系过滤出相应的数据。详情请参考 参数过滤。  
数据列 | 数据列过滤是指通过设置数据列与另一个数据集中数据列的关联从而实现数据集之间关联关系的一种定制方法。详情请参考 电子表格⬝ 多数据集报表。  
表达式设置 |  设置过滤表达式。 该设置项与类型有关，类型不同表达式设置的方式不同，详情可参考  
逻辑运算符 | 设置过滤表达式的逻辑运算符，有：AND（和）、OR（或）。  
增加 |  增加过滤表达式。 设置过滤表达式后，点击 **增加** 按钮，则在表达式区域显示表达式。  
修改 |  修改过滤表达式。 选择表达式区域的某条表达式，在表达式设置/逻辑运算符重新设置，点击 **修改** 按钮，过滤表达式被修改。  
删除过滤表达式。 选中过滤表达式，点击 **删除** 按钮，则删除该过滤表达式。  
上移 | 向上移动过滤表达式位置，用于多条过滤表达式调整顺序。  
下移 | 向下移动过滤表达式位置，用于多条过滤表达式调整顺序。  
增加括号 |  对过滤表达式增加括号，要求同时选中2条或2条以上表达式时才能使用括号（按住Ctrl键可选择多条表达式。）  
去掉括号 | 对过滤表达式去掉括号。  
## 4、值过滤 
值过滤是指通过设置数据列的值过滤出相应的数据。
**过滤条件：**
设置“发货区域”的过滤条件：类型为“值”；条件为：发货区域等于“东北”or 发货区域等于“华北”，如图：
**预览效果：**
只显示发货区域等于“东北”或“华北”的数据，如图：
### 功能说明
可选列 |  列出所选单元格对应数据集中包含的字段。 默认是选中单元格对应的字段，可以根据需要选择当前数据集其他字段进行表达式设置。  
---|---  
操作 | 用于设置“可选列”与“输入值”之间的关系，有：等于、不等于、大于、大于等于、小于、小于等于、始于、不始于、止于、不止于、包含、不包含、被包含于、不被包含于。  
值 |  用于输入具体的值。用于预览数据和选择数据。 点击 ，弹出“预览数据”界面，如图： 操作说明：
  * 选择：选择数据，从变为表示选中该行数据。
  * 添加：添加所选数据到输入值。 
  * 确定：点击**确定** 按钮，将所选数据作为“输入值”的唯一值。 
  * 取消：取消预览或选择数据。

  
空值 |  设置字段空值的过滤条件。 勾选“空值”，“输入值”置灰，表达式为“字段名称=null”，如图：  
##  5、参数过滤
参数过滤是指通过设置数据列的值与参数值的关系过滤出相应的数据。
### 示例
电子表格两个报表分别来自两个数据集：数据集1、数据集2；参数“发货区域”为数据集1的参数，从下图可以看出，参数只对来自数据集1的报表产生影响。
**过滤条件：**
选择来自数据集2报表的“发货城市”字段，设置表达式为：类型为“参数”，条件为：发货区域等于“$发货区域”，如图：
**预览效果：**
来自数据集2的报表也受参数值的影响，如图：
### 功能说明
可选列 |  列出所选单元格对应数据集中包含的字段。 默认是选中单元格对应的字段，可以根据需要选择当前数据集其他字段进行表达式设置。  
---|---  
操作 | 用于设置“可选列”与“值”之间的关系，有：等于、不等于、大于、大于等于、小于、小于等于、始于、不始于、止于、不止于、包含、不包含、被包含于、不被包含于。  
值 | 当前数据集中包含的参数列表，根据需要选择。  
## 6、数据列过滤
数据列过滤是指通过设置数据列与另一个业务查询中数据列的关联而实现数据集之间关联关系的一种定制方法，通过定制数据集之间的关联关系实现跨数据集查询。
如下图在该电子表格中，产品目录名称来自"简单产品目录查询"，产品名称和单位价格字段来自"简单产品查询"。
设置数据列过滤后，根据"产品目录编号"进行关联，查询出来的数据如下图所示：
两数据集通过设置数据列过滤条件，使两数据集产品目录编号进行关联，实现跨数据集查询。
在"过滤"窗口中设置：类型选择"数据列"，可选列选择"产品目录编号"，操作选择"等于"，数据集选中"简单产品目录查询" ,列选择"产品目录编号"。单击**增加**
根据产品目录名称进行分组，如下图所示 ：
### 功能说明
列 | 和数据集联动，列出所选数据集中包含的字段。  
---|---  
可选列 | 列出所选单元格对应数据集中包含的字段，默认是选中单元格对应的字段。可以根据需要选择当前数据集其它的字段进行表达式设置。  
操作 | 用于设置可选字段和输入值之间的关系。默认是等于。主要包含：等于、不等于、大于、大于等于、小于、小于等于、始于、不始于、止于、不止于、包含、不包含于、被包含于和不被包含于。  
数据集 | 当前电子表格包含的数据集列表。  
