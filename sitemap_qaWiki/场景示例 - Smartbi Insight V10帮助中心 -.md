
## 报表简介
本示例在电子表格中实现资产负债表。
## 示例效果
表格中如“流动资产”“货币资金”“短期借款”等数据，都是直接从数据库中获取。
当切换年度指标后，数据也随之变化。


## 数据要求
资产负债表中的所有数据储存于“balance_sheet”中，如下：
## 分析定制
该报表功能的实现详情如下：
1、创建数据源“huixie”，连接数据存储的数据库，如下：
2、填写SQL映射表
在“分析展现”界面的左侧目录区“分析报表”目录下，点击 **分析报表 > system > 分析报表 >SQL映射表** ，填写两个命名SQL，如下：
  * 期初：实现的作用是在数据库中查询出“期初”数据。
  * 期末：实现的作用是在数据库中查询出“期末”数据。


其中，SQL语句：select qichu from balance_sheet where f_year=? And kemu=trim(?) 中的两个?表示需要从公式中传入值代替?所在的位置。
3、新建数据模型
在数据模型中新建即席查询 ，选择”huxie"数据源，并勾选字段如下：
设置“qichu"和”qimo“维度字段为度量，保存数据模型。
4、创建电子表格
新建电子表格，并填入资产负债表的各个指标，如下：
5、新建模型查询
数据来源选择刚才创建的数据模型，勾选字段并拖拽“year"字段作为模型查询的参数：
6、设置”年“参数映射
点击工具栏中的 **参数管理** ，新建”月“参数映射如图：
7、设置参数绑定单元格
点击工具栏中的 **参数排版** 按钮，设置私有查询参数绑定单元格为D4。
8、设置“流动资产”的期初余额
选单元格B6，填入公式：=SSR_ExecNamedSQL("DS.huixie","期初",$D$4,A6) 。
**DS.huixie这个是数据源的节点ID名称(右键数据源名称属性里能看到)**
该公式实现的功能是：在数据源“huixie”所连接的数据库中，执行命名SQL“期初”，并将返回的唯一结果数据填写到单元格B6中。
关于该函数的说明，详情请参考 SSR_ExecNamedSQL。
9、设置“流动资产”的期末余额
选中单元格C6，填入公式：=SSR_ExecNamedSQL("DS.huixie","期末",$D$4,A6)
10、设置剩余指标数据
分别选中B6和C6单元格，复制到其他单元格，其他单元格会相应改变最后一个传递的单元格位置。也可手动输入公式。
11、发布报表。
## 示例资源  
