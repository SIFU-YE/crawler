
## 1 概述
用户在查看图表数据时，有时需要根据实际业务场景动态调整数据展示顺序，帮助用户直观地发现某些数据趋势。典型的应用场景如下：
按月份排序查看整年的销售量波动。  
---  
按投诉量降序定位高频问题品类。  
**多维度对比决策** | 按"转化率降序→客单价升序"筛选高价值用户群。  
1、当前文档的排序功能仅支持使用数据模型引擎V2.0版本的场景，数据模型引擎V2.0版本的说明详见 数据模型引擎V2.0。
2、当前文档的排序功能仅支持2025-04-01之后的V11版本。
## 2 排序逻辑
### 2.1 排序设置
**一个排序设置分为3部分组成，排序范围、排序依据和排序方式** 。
  * 排序范围：全局排序、组内排序
  * 排序依据：按当前字段排序、自定义排序、按其他字段排序。
  * 排序方式：升序、降序


比如可以设置 城市按销售额全局升序展示、行业名称按自定义组内降序排序，通过**排序范围+排序依据+排序方式** 可以满足各种排序场景，下面通过简单的示例图直观地说明每种排序设置的效果。
#### 2.1.1 排序范围
1、排序范围指当前排序影响的区域范围，包括 **全局排序、组内排序** 两种，示例效果图如下，具体说明详见：多字段排序逻辑：
  * 全局排序 指不受当前分组结构限制，排序结果影响整个所有数据。
  * 组内排序 指对最小的分组维内数据进行排序。


2、 排序设置范围支持情况：
  * 树状表、图形组件、筛选器组件不支持全局排序，仅支持组内排序。
  * 明细表不支持组内排序，仅支持全局排序。


#### 2.1.2 排序依据
排序依据指排序时按照什么顺序逻辑进行排序，包括：**按当前字段排序、自定义排序 和 按其他字段排序** 三种。
1、**按当前字段排序** 指根据当前点击排序的字段值进行排序。具体的示例说明详见 基础场景示例 。
  * 基于字符串字段排序时，是按照字符集顺序排，不同的数据库类型的字符集排序结果可能会不一样。
  * 如果字段是ASCII编码、TEXT，有一些数据库不支持排序，比如sql server就不支持排序。


2、**自定义排序** 指用户手动自定义设置排序项顺序，仅维度字段支持自定义排序。具体的示例说明详见 自定义排序 。
3、**按其他字段排序** 指可以选择一个未添加到组件上的字段作为排序依据，仅维度字段支持按其他字段排序。具体的示例说明详见 按其他字段排序 。
#### 2.1.3 排序方式
排序方式指根据设置的排序依据，按从小到大或从大到小的顺序排序，包括：**升序、降序** 两种。
### 2.2 多字段排序逻辑
一个组件中如果含多个字段时，每个字段都支持设置排序，若这些字段排序结果影响的区域有重叠时，排序优先级说明详见 多字段排序逻辑 。
下面通过一个简单的场景示例说明如何设置排序。
### 3.1 场景示例说明
现在希望能根据销售额降序看全国各个省份和城市的销售情况，排序设置操作步骤如下：
1、设置入口
将所需的字段添加到图表组件上，在**销售额** 字段上设置 **排序 > 全局降序** ，如下图所示：
排序设置入口有两个，入口1：在数据面板作图区域的字段菜单上设置；入口2：在表格表头字段名称单元格的菜单上设置。
2、即可得到场景中所期望的效果，如下图所示：
### 3.2 排序菜单说明
1、在字段菜单上的 **全局升序、全局降序、组内升序和组内降序** ，是系统提供的一种快捷排序入口，其排序依据是 **按当前字段排序** ，排序效果和在**高级排序** 中设置一致。
2、某个字段上已经设置了排序，若想要取消排序，可在排序菜单中选择**清除当前字段排序** ，效果如下图所示：
3、组件上有字段设置了排序后，可在排序菜单中点击 **查看排序优先级** ，查看影响数据顺序的排序设置优先级，此功能常用于在一个组件上设置了多个字段排序的场景，详见 多字段排序逻辑 。
  * 排序优先级组成：排序位置 [排序范围][排序依据][排序方式]，示例如下图所示：
  * 排序按照从上到下优先级从高到低生效。


## 4 排序相关功能说明
### 4.1 小计/合计
1、组内排序
  * 在维度上排序时，小计合计行/列不参与排序，如下图所示，在产品类别上设置组内降序排序，每个发货区域对应的小计值不参与产品类别的排序。


  * 在度量上设置排序，每个层级的小计行/列最终也会受排序影响，如下图所示，在销售量上设置了组内升序排序：
    * 对于华南区域分组内，每个产品类别的小计会组内升序展示数据。
    * 对于所有的发货区域的小计行，也会组内升序展示数据。


2、全局排序
全局排序时，会打乱表格原本的分组结构，小计合计行/列的数据和原本字段的数据分为两部分，显示顺序说明如下：
  * 全局排序后，通过组件属性设置的**显示位置****合计/小计** 在表格的显示位置，如下图所示，是设置行上的合计/小计显示在顶部和底部的对比。
  * 然后同层级的小计、字段数据分别按照排序设置进行全局排序。


## 5 注意事项
1、数据模型层会默认根据组件上使用到的所有维度做升序排序。
2、在数据模型的查询中设置了排序后，在报表上查看数据时，数据模型的查询中设置的排序默认会被数据模型层的排序覆盖。
3、切换组件类型时，会自动清除无效排序设置。
无效的排序设置指切换后的组件是否支持对应的排序范围、排序依据、以及排序字段位置和路径是否还存在。  
