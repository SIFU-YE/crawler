# Smartbi报表宏api
# simpleReport
即席查询对象
## 接口摘要
### 方法


### 属性


## 方法
### `addAutoCmdByAlias`
(
  * `colAlias`
  * `menuAlias`

)
通过字段别名，添加宏自动执行标识
#### 参数:
  * `colAlias` String
  * `menuAlias` String
跳转规则菜单别名


### `addAutoCmdByName`
(
  * `colName`
  * `menuAlias`

)
通过字段名称，添加宏自动执行标识
#### 参数:
  * `colName` String
  * `menuAlias` String
跳转规则菜单别名


### `addCellLink`
(
  * `jumpRule`

)
通过行列索引号，添加单元格链接
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule


#### 示例:
```
function main(simpleReport, simpleReportContext){
   simpleReport.addCellLink(1,0, jumpRule);}//创建跳转规则var jumpRule ={alias:"跳转",
   callback:function(simpleReport, simpleReportContext){
       simpleReport.writeParamsToContext();var paramsInfo =newArray();var realValue = simpleReport.getCurrentFieldRealValue("产品名称");var dispValue = simpleReport.getCurrentFieldValue("产品名称");var paramInfo = createParamInfo("BIZATTR_northwind_订单主题_ProductName", realValue, realValue);
       paramsInfo.push(paramInfo);//携带参数打开报表id为 "I8a8a9fbc0175bf0ebf0edc600175bf23c3ee0183" 的标签页var topWinJsLoader = window.jsloader;try{if(window.top.jsloader){
             topWinJsLoader = window.top.jsloader;}}catch(e){}var openner = domutils.isMobile()?window.jsloader.resolve("bof.macro.views.Openner"):topWinJsLoader.resolve("bof.macro.views.Openner");
        openner.openInTab("I8a8a9fbc0175bf0ebf0edc600175bf23c3ee0183",paramsInfo);}}//拼接参数function createParamInfo(name, value, disValue){var paramInfo =newObject();
   paramInfo.name = name;
   paramInfo.value = value +"";
   paramInfo.displayValue = disValue +"";return paramInfo;}
```

### `addChartLinkByIndex`
(
  * `jumpRule`

)
通过图形索引，添加图形链接
#### 参数:
  * `index` int
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addChartLinkByTitle`
(
  * `jumpRule`

)
通过图形标题，添加图形链接
#### 参数:
  * `title` String
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addColumnLink`
(
  * `jumpRule`

)
通过列索引号，添加列链接
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addColumnLinkByAlias`
(
  * `colAlias`
  * `jumpRule`

)
通过字段别名，添加列链接
#### 参数:
  * `colAlias` String
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addColumnLinkByName`
(
  * `colName`
  * `jumpRule`

)
通过字段名称，添加列链接
#### 参数:
  * `colName` String
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addFilterLinkByAlias`
(
  * `colAlias`
  * `jumpRule`
  * `filterStr`

)
通过字段别名，根据条件添加列链接
#### 参数:
  * `colAlias` String
  * `jumpRule` Object
跳转规则对象 jumpRule
  * `filterStr` String
判断条件的字符串，比如："月!='3'"表示“月”那列的值不等于3


#### 示例:
```
//为字段为产品名称并且产品名称值为小米的单元格添加链接
simpleReport.addFilterLinkByAlias("产品名称", jumpRule,"产品名称 == '小米'")
```

### `addRowLink`
(
  * `jumpRule`

)
通过行索引号，添加行链接
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule


### `addTitleLink`
(
  * `jumpRule`

)
添加标题链接
#### 参数:
  * `title` Object
  * `jumpRule` Object
跳转规则对象 jumpRule


### `autoFillParams`
()
根据当前报表的名称，自动从simpleReportContext中读取对应的参数数据，进行填充
### `fillParamValue`
(
  * `pValue`
  * `pDisplayValue`

)
填允参数信息
#### 参数:
  * `pName` String
  * `pValue` Object
  * `pDisplayValue` String


### `fillParamValueFromObj`
(
  * `paramObj`

)
填允参数信息
#### 参数:
  * `pName` String
  * `paramObj` Object
参数值对象


### `getCellsValueFromField`
(
  * `fieldAlias`

)
通过字段别名，获取该字段下所有单元格的值
#### 参数:
  * `fieldAlias` String


#### 返回值:
String: 
多个单元格的值组合的字符串
#### 示例:
```
function main(simpleReport, simpleReportContext){//获取产品名称这一列的所有数据var str = simpleReport.getCellsValueFromField('产品名称')
    console.log(str);}输出："沙茶,猪肉干,虾子,猪肉干,海苔酱,糯米,小米,海苔酱,桂花糕,浪花奶酪"
```

### `getCurrentFieldRealValue`
(
  * `fieldAlias`

)
String | Number
通过字段别名，获取当前点击了跳转链接的单元格的指定字段的真实值
#### 参数:
  * `fieldAlias` String


#### 返回值:
String | Number: 
单元格的真实值
### `getCurrentFieldValue`
(
  * `fieldAlias`

)
通过字段别名，获取当前点击了跳转链接的单元格的指定字段的显示值
#### 参数:
  * `fieldAlias` String


#### 返回值:
String: 
单元格的显示值
### `getFieldAlias`
通过字段索引号获取字段别名
#### 参数:
  * `fieldid` String
字段索引号


#### 返回值:
String: 
字段别名
#### 示例:
```
function main(simpleReport, simpleReportContext){//通过第一列的索引号(id)获取表头字段别名var fieldid = simpleReport.getFields()[0].id;var str = simpleReport.getFieldAlias(fieldid)
    console.log(str);}输出："产品名称"
```

### `getFieldDatasByJump`
根据跳转规则获取传递字段对象
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule


#### 返回值:
Object: 
传递字段对象
### `getFieldIndexByAlias`
(
  * `fieldAlias`

)
通过字段别名获取字段索引号
#### 参数:
  * `fieldAlias` String


#### 返回值:
### `getFieldIndexByName`
(
  * `fieldName`

)
通过字段名称获取字段索引号
#### 参数:
  * `fieldName` String


#### 返回值:
### `getRelatedFieldsByJump`
根据跳转规则获取关联字段对象数组
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule


#### 返回值:
Array: 
关联字段对象数组(包括srcFieldIds和destFieldIds的数组)
### `refreshData`
()
### `setFieldVisible`
(
  * `fieldID`
  * `visible`

)
设置字段列可见
#### 参数:
  * `fieldID` String
字段列ID
  * `visible` boolean
字段列是否可见


#### 示例:
```
function main(simpleReport, simpleReportContext){//获取第一列的字段列idvar fieldID = simpleReport.getFields()[0].id;//隐藏第一列
    simpleReport.setFieldVisible(fieldID,false);}
```

### `setParamValue`
(
  * `paramId`
  * `paramValue`
  * `[paramDisplayValue]`

)
设置参数值
#### 参数:
  * `paramId` String
  * `paramValue` String | Number
参数真实值
  * `[paramDisplayValue]` String optional
参数显示值


#### 示例:
```
//获取产品类别参数的id，设置参数真实值为饮料并刷新报表。function main(simpleReport, simpleReportContext, param){varparams= simpleReport.getParams();for(var=0;params.length;++){if(params[i].alias=='产品类别'){var paramId =params[i].id;
            simpleReport.setParamValue(paramId,'饮料');
            simpleReport.doRefresh();break;}}}
```

### `showSelectReportFieldsDialog`
(
  * `jumpRule`
  * `destQueryId`
  * `hideTransFields`

)
弹出即席查询字段选择窗口，适用于列跳转
#### 参数:
  * `jumpRule` Object
跳转规则对象 jumpRule
  * `destQueryId` String
即席查询ID
  * `hideTransFields` boolean


### `writeParamsToContext`
()
把当前报表的参数信息保存到simpleReportContext对象中
## 属性
### `currentCellValue`
String
当前单元格的值
### `currentLinkCell`
HTML
当前链接单元格所在的HTML DOM元素
### `currentLinkCol`
int
当前链接列索引号
### `currentLinkRow`
int
当前链接行索引号
### `grid`
即席查询表格对象
## APIs
首页


